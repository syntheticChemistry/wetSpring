# Experiment 026 — Liu 2014 HMM Primitives

**Date:** 2026-02-20
**Status:** COMPLETE
**Track:** 1b (Comparative Genomics)
**Faculty:** Liu (CSE, MSU)

---

## Objective

Implement and validate core HMM primitives (forward, backward, Viterbi, posterior
decoding) needed for PhyloNet-HMM introgression detection (Liu et al. 2014,
PLoS Comp Bio 10:e1003649).

All computation uses log-space arithmetic with log-sum-exp for numerical stability.
These are the same primitives needed by ToadStool's LogSumExp shader for GPU
acceleration of genomic HMMs.

## Models

### 2-state weather model (Rabiner tutorial)
- States: Rainy (0), Sunny (1)
- Symbols: Walk (0), Shop (1), Clean (2)
- Observation: [Walk, Shop, Clean, Walk, Shop]

### 3-state genomic model
- 3 hidden states, 2 emission symbols
- Observation: [0, 1, 0, 0, 1, 1, 0]

## Python Baseline Values

| Metric | 2-state | 3-state |
|--------|---------|---------|
| Log-likelihood | -5.75824001 | -5.01748302 |
| Viterbi path | [1,0,0,1,1] | [0,1,0,0,1,1,0] |
| Viterbi log-prob | -7.73911680 | -9.20260080 |

## Validation Binary

```bash
cargo run --bin validate_hmm
```

## Modules Validated

- `bio::hmm` — log-space forward, backward, Viterbi, posterior decode, log-sum-exp
